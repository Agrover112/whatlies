



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>What Are Embeddings - whatlies</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="purple">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#imaginary-tokens" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="whatlies" aria-label="whatlies" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              whatlies
            </span>
            <span class="md-header-nav__topic">
              
                What Are Embeddings
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="whatlies" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    whatlies
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        What Are Embeddings
      </label>
    
    <a href="./" title="What Are Embeddings" class="md-nav__link md-nav__link--active">
      What Are Embeddings
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#imaginary-tokens" class="md-nav__link">
    Imaginary Tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meaning" class="md-nav__link">
    Meaning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#king-man-woman" class="md-nav__link">
    King - Man + Woman
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#king-queen" class="md-nav__link">
    King - Queen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-queen-king" class="md-nav__link">
    Man | (Queen - King)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-mathmatics" class="md-nav__link">
    Embedding Mathmatics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-operations" class="md-nav__link">
    More Operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-unto-tokens" class="md-nav__link">
    Mapping Unto Tokens
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#measuring-the-mapping" class="md-nav__link">
    Measuring the Mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interesting" class="md-nav__link">
    Interesting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting-high-dimensions" class="md-nav__link">
    Plotting High Dimensions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../embeddingsets/" title="Interactive Visualisation" class="md-nav__link">
      Interactive Visualisation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Language Options" class="md-nav__link">
      Language Options
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/embedding/" title="Embedding" class="md-nav__link">
      Embedding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/embeddingset/" title="EmbeddingSet" class="md-nav__link">
      EmbeddingSet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/transformers/" title="Transformers" class="md-nav__link">
      Transformers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/language/" title="Language" class="md-nav__link">
      Language
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#imaginary-tokens" class="md-nav__link">
    Imaginary Tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meaning" class="md-nav__link">
    Meaning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#king-man-woman" class="md-nav__link">
    King - Man + Woman
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#king-queen" class="md-nav__link">
    King - Queen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-queen-king" class="md-nav__link">
    Man | (Queen - King)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-mathmatics" class="md-nav__link">
    Embedding Mathmatics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-operations" class="md-nav__link">
    More Operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-unto-tokens" class="md-nav__link">
    Mapping Unto Tokens
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#measuring-the-mapping" class="md-nav__link">
    Measuring the Mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interesting" class="md-nav__link">
    Interesting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting-high-dimensions" class="md-nav__link">
    Plotting High Dimensions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>What Are Embeddings</h1>
                
                <h2 id="imaginary-tokens">Imaginary Tokens<a class="headerlink" href="#imaginary-tokens" title="Permanent link">&para;</a></h2>
<p>Let's make a few word-embeddings. The basic object for this is a <code>Token</code> object.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">whatlies</span> <span class="kn">import</span> <span class="n">Embedding</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span> 
<span class="n">bar</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">buz</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;buz&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</code></pre></div>

<p>These are all embedding objects. It has a name and a vector. 
It also has a representation.</p>
<div class="codehilite"><pre><span></span><code><span class="n">foo</span> <span class="c1"># Emb[foo]</span>
</code></pre></div>

<p>We can also apply operations on it as if it was a vector. </p>
<div class="codehilite"><pre><span></span><code><span class="n">foo</span> <span class="o">|</span> <span class="p">(</span><span class="n">bar</span> <span class="o">-</span> <span class="n">buz</span><span class="p">)</span> <span class="c1"># Emb[(foo | (bar - buz))]</span>
</code></pre></div>

<p>This will also change the internal vector. </p>
<div class="codehilite"><pre><span></span><code><span class="n">foo</span><span class="o">.</span><span class="n">vector</span>                  <span class="c1"># array([ 0.50,  0.10]</span>
<span class="p">(</span><span class="n">foo</span> <span class="o">|</span> <span class="p">(</span><span class="n">bar</span> <span class="o">-</span> <span class="n">buz</span><span class="p">))</span><span class="o">.</span><span class="n">vector</span>  <span class="c1"># array([ 0.06, -0.12])</span>
</code></pre></div>

<p>But why read when we can plot? The whole point of this package is
to make it visual. </p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">buz</span><span class="p">]:</span>
    <span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img1.png" /></p>
<h2 id="meaning">Meaning<a class="headerlink" href="#meaning" title="Permanent link">&para;</a></h2>
<p>Let's come up with imaginary embeddings for <code>man</code>, <code>woman</code>, <code>king</code> and <code>queen</code>. </p>
<p>We will plot them using the <code>arrow</code> plotting type.</p>
<div class="codehilite"><pre><span></span><code><span class="n">man</span>   <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">woman</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;woman&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span class="n">king</span>  <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">])</span>
<span class="n">queen</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>

<span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">queen</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img2.png" /></p>
<h3 id="king-man-woman">King - Man + Woman<a class="headerlink" href="#king-man-woman" title="Permanent link">&para;</a></h3>
<p>We can confirm the classic approximation that everybody likes to mention.</p>
<div class="codehilite"><pre><span></span><code><span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">queen</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">king</span> <span class="o">-</span> <span class="n">man</span> <span class="o">+</span> <span class="n">woman</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img3.png" /></p>
<h3 id="king-queen">King - Queen<a class="headerlink" href="#king-queen" title="Permanent link">&para;</a></h3>
<p>But maybe I am interested in the vector that spans between <code>queen</code> and <code>king</code>. I'll use the <code>-</code> operator here to indicate the connection between the two tokens. </p>
<blockquote>
<p>Notice the poetry there... </p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">queen</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">queen</span> <span class="o">-</span> <span class="n">king</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">show_operations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img4.png" /></p>
<h3 id="man-queen-king">Man | (Queen - King)<a class="headerlink" href="#man-queen-king" title="Permanent link">&para;</a></h3>
<p>But that space <code>queen-king</code> ... we can also filter all that information out of our words. Linear algebra would call this "making it orthogonal". The <code>|</code> operator makes sense here.</p>
<div class="codehilite"><pre><span></span><code><span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">queen</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">queen</span> <span class="o">-</span> <span class="n">king</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">show_operations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">man</span> <span class="o">|</span> <span class="p">(</span><span class="n">queen</span> <span class="o">-</span> <span class="n">king</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">show_operations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img5.png" /></p>
<h2 id="embedding-mathmatics">Embedding Mathmatics<a class="headerlink" href="#embedding-mathmatics" title="Permanent link">&para;</a></h2>
<p>This is interesting. We have our original tokens and can filter away 
the <code>(man-woman)</code> axis. By doing this we get "new" embeddings with 
different properties. Numerically we can confirm in our example that 
this new space maps <code>Emb(man)</code> to be very similar to <code>Emb(woman)</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">man</span> <span class="o">|</span> <span class="p">(</span><span class="n">queen</span> <span class="o">-</span> <span class="n">king</span><span class="p">))</span><span class="o">.</span><span class="n">vector</span>    <span class="c1"># array([0.5, 0. ]</span>
<span class="p">(</span><span class="n">woman</span> <span class="o">|</span> <span class="p">(</span><span class="n">queen</span> <span class="o">-</span> <span class="n">king</span><span class="p">))</span><span class="o">.</span><span class="n">vector</span>  <span class="c1"># array([0.49999999, 1e-16. ]</span>
</code></pre></div>

<p>The same holds for <code>Emb(queen)</code> and <code>Emb(man)</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">queen</span> <span class="o">|</span> <span class="p">(</span><span class="n">man</span> <span class="o">-</span> <span class="n">woman</span><span class="p">))</span><span class="o">.</span><span class="n">vector</span>   <span class="c1"># array([0.7, 0. ]</span>
<span class="p">(</span><span class="n">king</span> <span class="o">|</span> <span class="p">(</span><span class="n">man</span> <span class="o">-</span> <span class="n">woman</span><span class="p">))</span><span class="o">.</span><span class="n">vector</span>    <span class="c1"># array([0.7, 0. ]</span>
</code></pre></div>

<h2 id="more-operations">More Operations<a class="headerlink" href="#more-operations" title="Permanent link">&para;</a></h2>
<p>Let's consider some other operations. For this we will 
make new embeddings. </p>
<div class="codehilite"><pre><span></span><code><span class="n">man</span>   <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">])</span>
<span class="n">woman</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;woman&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">king</span>  <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>

<span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img6.png" /></p>
<h2 id="mapping-unto-tokens">Mapping Unto Tokens<a class="headerlink" href="#mapping-unto-tokens" title="Permanent link">&para;</a></h2>
<p>In the previous example we demonstrated how to map "away" from vectors. 
But we can also map "unto" vectors. For this we introduce the <code>&gt;&gt;</code> operator.</p>
<div class="codehilite"><pre><span></span><code><span class="n">man</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">woman</span> <span class="o">&gt;&gt;</span> <span class="n">man</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">woman</span> <span class="o">&gt;&gt;</span> <span class="n">king</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img7.png" /></p>
<h3 id="measuring-the-mapping">Measuring the Mapping<a class="headerlink" href="#measuring-the-mapping" title="Permanent link">&para;</a></h3>
<p>Note that the <code>woman</code> vector in our embedding maps partially unto <code>man</code> and 
overshoots a bit on <code>king</code>. We can quantify this by measuring what percentage 
of the vector is covered. This factor can be retreived by using the <code>&gt;</code> operator.</p>
<div class="codehilite"><pre><span></span><code><span class="n">woman</span> <span class="o">&gt;</span> <span class="n">king</span>  <span class="c1"># 1.3749</span>
<span class="n">woman</span> <span class="o">&gt;</span> <span class="n">man</span>   <span class="c1"># 0.7522</span>
</code></pre></div>

<h2 id="interesting">Interesting<a class="headerlink" href="#interesting" title="Permanent link">&para;</a></h2>
<p>This suggests that perhaps ... <code>king</code> and <code>man</code> can be used as axes for plotting? </p>
<p>It would also work if the embeddings were in a very high dimensional plane. </p>
<p>No matter how large the embedding, we could've said <code>woman</code> spans 1.375 of 
<code>king</code> and 0.752 of <code>man</code>. Given <code>king</code> as the x-axis and <code>man</code> as the y-axis, 
we can map the token of <code>man</code> to a 2d representation (1.375, 0.752) 
which is easy to plot.</p>
<p>This is an interesting way of thinking about it. We can plot high 
dimensional vectors in 2d as long as we can plot it along two axes. 
An axis could be a vector of a token, or a token that has had operations on it. </p>
<p>Note that this <code>&gt;</code> mapping can also cause negative values. </p>
<div class="codehilite"><pre><span></span><code><span class="n">foo</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">])</span>

<span class="n">foo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="n">woman</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">king</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">foo</span> <span class="o">&gt;&gt;</span> <span class="n">woman</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">show_operations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-.</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-.</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</code></pre></div>

<p><img alt="" src="tut1-img8.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">foo</span> <span class="o">&gt;</span> <span class="n">woman</span> <span class="c1"># -0.6769</span>
</code></pre></div>

<h2 id="plotting-high-dimensions">Plotting High Dimensions<a class="headerlink" href="#plotting-high-dimensions" title="Permanent link">&para;</a></h2>
<p>Let's confirm this idea by using some spaCy word-vectors.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">spacy</span> 
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_md&#39;</span><span class="p">)</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;fish&quot;</span><span class="p">,</span> <span class="s2">&quot;kitten&quot;</span><span class="p">,</span> <span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span> <span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">]</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">words</span><span class="p">)}</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;man&#39;</span><span class="p">]</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;woman&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="o">=</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="n">y_axis</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="n">y_axis</span><span class="p">)</span>
</code></pre></div>

<p><img alt="" src="tut1-img9.png" /></p>
<p>The interesting thing here is that we can also perform operations on these words
before plotting them. </p>
<div class="codehilite"><pre><span></span><code><span class="n">royalty</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;king&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;queen&#39;</span><span class="p">]</span>
<span class="n">gender</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;man&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">tokens</span><span class="p">[</span><span class="s1">&#39;woman&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="p">(</span><span class="n">t</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="o">=</span><span class="n">royalty</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="n">gender</span><span class="p">)</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="n">royalty</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="n">gender</span><span class="p">))</span>
</code></pre></div>

<p><img alt="" src="tut1-img10.png" /></p>
<p>The idea seems to work. But maybe we can introduce cooler charts and easier was
to deal with collections of embeddings.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../.." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../embeddingsets/" title="Interactive Visualisation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Interactive Visualisation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>