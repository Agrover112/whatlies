



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Transformers - whatlies</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="purple">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#whatlies.transformers.noise" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="whatlies" aria-label="whatlies" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              whatlies
            </span>
            <span class="md-header-nav__topic">
              
                Transformers
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="whatlies" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    whatlies
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../tutorial/embeddings/" title="What Are Embeddings" class="md-nav__link">
      What Are Embeddings
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../tutorial/embeddingsets/" title="Interactive Visualisation" class="md-nav__link">
      Interactive Visualisation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../tutorial/languages/" title="Language Options" class="md-nav__link">
      Language Options
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding/" title="Embedding" class="md-nav__link">
      Embedding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embeddingset/" title="EmbeddingSet" class="md-nav__link">
      EmbeddingSet
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Transformers
      </label>
    
    <a href="./" title="Transformers" class="md-nav__link md-nav__link--active">
      Transformers
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.noise" class="md-nav__link">
    noise()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.pca" class="md-nav__link">
    pca()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.random_adder" class="md-nav__link">
    random_adder()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.umap" class="md-nav__link">
    umap()
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../language/" title="Language" class="md-nav__link">
      Language
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.noise" class="md-nav__link">
    noise()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.pca" class="md-nav__link">
    pca()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.random_adder" class="md-nav__link">
    random_adder()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whatlies.transformers.umap" class="md-nav__link">
    umap()
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Transformers</h1>
                
                <h2 id="whatlies.transformers.noise"><code class="codehilite"><span class="n">noise</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span></code><a class="headerlink" href="#whatlies.transformers.noise" title="Permanent link">&para;</a></h2>
<div class="autodoc">
<details class="note"><summary>Show source code in <code>whatlies/transformers.py</code></summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">noise</span><span class="p">(</span><span class="n">sigma</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This transformer adds gaussian noise to an embeddingset.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        sigma: the amount of gaussian noise to add</span>
<span class="sd">        seed: seed value for random number generator</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    from whatlies.language import SpacyLanguage</span>
<span class="sd">    from whatlies.transformers import pca</span>

<span class="sd">    words = [&quot;prince&quot;, &quot;princess&quot;, &quot;nurse&quot;, &quot;doctor&quot;, &quot;banker&quot;, &quot;man&quot;, &quot;woman&quot;,</span>
<span class="sd">             &quot;cousin&quot;, &quot;neice&quot;, &quot;king&quot;, &quot;queen&quot;, &quot;dude&quot;, &quot;guy&quot;, &quot;gal&quot;, &quot;fire&quot;,</span>
<span class="sd">             &quot;dog&quot;, &quot;cat&quot;, &quot;mouse&quot;, &quot;red&quot;, &quot;bluee&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;water&quot;,</span>
<span class="sd">             &quot;person&quot;, &quot;family&quot;, &quot;brother&quot;, &quot;sister&quot;]</span>

<span class="sd">    lang = SpacyLanguage(&quot;en_core_web_md&quot;)</span>
<span class="sd">    emb = lang[words]</span>

<span class="sd">    emb.transform(noise(3))</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">embset</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">names_out</span><span class="p">,</span> <span class="n">embs</span> <span class="o">=</span> <span class="n">embset_to_X</span><span class="p">(</span><span class="n">embset</span><span class="o">=</span><span class="n">embset</span><span class="p">)</span>
        <span class="n">vectors_out</span> <span class="o">=</span> <span class="n">embs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">embs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EmbeddingSet</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">orig</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_out</span><span class="p">,</span> <span class="n">vectors_out</span><span class="p">)})</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div>
</td></tr></table>

</details>
<p>This transformer adds gaussian noise to an embeddingset.</p>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sigma</code></td>
<td><code>float</code></td>
<td>the amount of gaussian noise to add</td>
<td><code>0.1</code></td>
</tr>
<tr>
<td><code>seed</code></td>
<td><code>int</code></td>
<td>seed value for random number generator</td>
<td><code>42</code></td>
</tr>
</tbody>
</table>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">whatlies.language</span> <span class="kn">import</span> <span class="n">SpacyLanguage</span>
<span class="kn">from</span> <span class="nn">whatlies.transformers</span> <span class="kn">import</span> <span class="n">pca</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;prince&quot;</span><span class="p">,</span> <span class="s2">&quot;princess&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;banker&quot;</span><span class="p">,</span> <span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
         <span class="s2">&quot;cousin&quot;</span><span class="p">,</span> <span class="s2">&quot;neice&quot;</span><span class="p">,</span> <span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="s2">&quot;dude&quot;</span><span class="p">,</span> <span class="s2">&quot;guy&quot;</span><span class="p">,</span> <span class="s2">&quot;gal&quot;</span><span class="p">,</span> <span class="s2">&quot;fire&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;bluee&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">,</span>
         <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;brother&quot;</span><span class="p">,</span> <span class="s2">&quot;sister&quot;</span><span class="p">]</span>

<span class="n">lang</span> <span class="o">=</span> <span class="n">SpacyLanguage</span><span class="p">(</span><span class="s2">&quot;en_core_web_md&quot;</span><span class="p">)</span>
<span class="n">emb</span> <span class="o">=</span> <span class="n">lang</span><span class="p">[</span><span class="n">words</span><span class="p">]</span>

<span class="n">emb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">noise</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div>

</div>
<h2 id="whatlies.transformers.pca"><code class="codehilite"><span class="n">pca</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code><a class="headerlink" href="#whatlies.transformers.pca" title="Permanent link">&para;</a></h2>
<div class="autodoc">
<details class="note"><summary>Show source code in <code>whatlies/transformers.py</code></summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">pca</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This transformer scales all the vectors in an [EmbeddingSet][whatlies.embeddingset.EmbeddingSet]</span>
<span class="sd">    by means of principal component analysis. We&#39;re using the implementation found in</span>
<span class="sd">    [scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        n_components: the number of compoments to create/add</span>
<span class="sd">        kwargs: keyword arguments passed to the PCA from scikit-learn</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    from whatlies.language import SpacyLanguage</span>
<span class="sd">    from whatlies.transformers import pca</span>

<span class="sd">    words = [&quot;prince&quot;, &quot;princess&quot;, &quot;nurse&quot;, &quot;doctor&quot;, &quot;banker&quot;, &quot;man&quot;, &quot;woman&quot;,</span>
<span class="sd">             &quot;cousin&quot;, &quot;neice&quot;, &quot;king&quot;, &quot;queen&quot;, &quot;dude&quot;, &quot;guy&quot;, &quot;gal&quot;, &quot;fire&quot;,</span>
<span class="sd">             &quot;dog&quot;, &quot;cat&quot;, &quot;mouse&quot;, &quot;red&quot;, &quot;bluee&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;water&quot;,</span>
<span class="sd">             &quot;person&quot;, &quot;family&quot;, &quot;brother&quot;, &quot;sister&quot;]</span>

<span class="sd">    lang = SpacyLanguage(&quot;en_core_web_md&quot;)</span>
<span class="sd">    emb = lang[words]</span>

<span class="sd">    emb.transform(pca(3)).plot_interactive_matrix(&#39;pca_0&#39;, &#39;pca_1&#39;, &#39;pca_2&#39;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">embset</span><span class="p">):</span>
        <span class="n">tfm</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">names</span><span class="p">,</span> <span class="n">embs</span> <span class="o">=</span> <span class="n">embset_to_X</span><span class="p">(</span><span class="n">embset</span><span class="o">=</span><span class="n">embset</span><span class="p">)</span>
        <span class="n">new_vecs</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">embs</span><span class="p">)</span>
        <span class="n">names_out</span> <span class="o">=</span> <span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;pca_</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)]</span>
        <span class="n">vectors_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">new_vecs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_components</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">EmbeddingSet</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">orig</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_out</span><span class="p">,</span> <span class="n">vectors_out</span><span class="p">)},</span>
                            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{embset.name}</span><span class="s2">.pca_</span><span class="si">{n_components}</span><span class="s2">()&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div>
</td></tr></table>

</details>
<p>This transformer scales all the vectors in an <a href="None#whatlies.embeddingset.EmbeddingSet">EmbeddingSet</a>
by means of principal component analysis. We're using the implementation found in
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">scikit-learn</a></p>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_components</code></td>
<td></td>
<td>the number of compoments to create/add</td>
<td><code>2</code></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td></td>
<td>keyword arguments passed to the PCA from scikit-learn</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">whatlies.language</span> <span class="kn">import</span> <span class="n">SpacyLanguage</span>
<span class="kn">from</span> <span class="nn">whatlies.transformers</span> <span class="kn">import</span> <span class="n">pca</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;prince&quot;</span><span class="p">,</span> <span class="s2">&quot;princess&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;banker&quot;</span><span class="p">,</span> <span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
         <span class="s2">&quot;cousin&quot;</span><span class="p">,</span> <span class="s2">&quot;neice&quot;</span><span class="p">,</span> <span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="s2">&quot;dude&quot;</span><span class="p">,</span> <span class="s2">&quot;guy&quot;</span><span class="p">,</span> <span class="s2">&quot;gal&quot;</span><span class="p">,</span> <span class="s2">&quot;fire&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;bluee&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">,</span>
         <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;brother&quot;</span><span class="p">,</span> <span class="s2">&quot;sister&quot;</span><span class="p">]</span>

<span class="n">lang</span> <span class="o">=</span> <span class="n">SpacyLanguage</span><span class="p">(</span><span class="s2">&quot;en_core_web_md&quot;</span><span class="p">)</span>
<span class="n">emb</span> <span class="o">=</span> <span class="n">lang</span><span class="p">[</span><span class="n">words</span><span class="p">]</span>

<span class="n">emb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pca</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">plot_interactive_matrix</span><span class="p">(</span><span class="s1">&#39;pca_0&#39;</span><span class="p">,</span> <span class="s1">&#39;pca_1&#39;</span><span class="p">,</span> <span class="s1">&#39;pca_2&#39;</span><span class="p">)</span>
</code></pre></div>

</div>
<h2 id="whatlies.transformers.random_adder"><code class="codehilite"><span class="n">random_adder</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code><a class="headerlink" href="#whatlies.transformers.random_adder" title="Permanent link">&para;</a></h2>
<div class="autodoc">
<details class="note"><summary>Show source code in <code>whatlies/transformers.py</code></summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">random_adder</span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This transformer adds random embeddings to the embeddingset.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        n: the number of random vectors to add</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    from whatlies.language import SpacyLanguage</span>
<span class="sd">    from whatlies.transformers import random_added</span>

<span class="sd">    words = [&quot;prince&quot;, &quot;princess&quot;, &quot;nurse&quot;, &quot;doctor&quot;, &quot;banker&quot;, &quot;man&quot;, &quot;woman&quot;,</span>
<span class="sd">             &quot;cousin&quot;, &quot;neice&quot;, &quot;king&quot;, &quot;queen&quot;, &quot;dude&quot;, &quot;guy&quot;, &quot;gal&quot;, &quot;fire&quot;,</span>
<span class="sd">             &quot;dog&quot;, &quot;cat&quot;, &quot;mouse&quot;, &quot;red&quot;, &quot;bluee&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;water&quot;,</span>
<span class="sd">             &quot;person&quot;, &quot;family&quot;, &quot;brother&quot;, &quot;sister&quot;]</span>

<span class="sd">    lang = SpacyLanguage(&quot;en_core_web_md&quot;)</span>
<span class="sd">    emb = lang[words]</span>

<span class="sd">    emb.transform(random_added(3)).plot_interactive_matrix(&#39;rand_0&#39;, &#39;rand_1&#39;, &#39;rand_2&#39;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">embset</span><span class="p">):</span>
        <span class="n">names_out</span><span class="p">,</span> <span class="n">embs</span> <span class="o">=</span> <span class="n">embset_to_X</span><span class="p">(</span><span class="n">embset</span><span class="o">=</span><span class="n">embset</span><span class="p">)</span>
        <span class="n">orig_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">orig</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_out</span><span class="p">,</span> <span class="n">embs</span><span class="p">)}</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;rand_</span><span class="si">{k}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rand_</span><span class="si">{k}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">embs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">EmbeddingSet</span><span class="p">({</span><span class="o">**</span><span class="n">orig_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">new_dict</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div>
</td></tr></table>

</details>
<p>This transformer adds random embeddings to the embeddingset.</p>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n</code></td>
<td><code>int</code></td>
<td>the number of random vectors to add</td>
<td><code>2</code></td>
</tr>
</tbody>
</table>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">whatlies.language</span> <span class="kn">import</span> <span class="n">SpacyLanguage</span>
<span class="kn">from</span> <span class="nn">whatlies.transformers</span> <span class="kn">import</span> <span class="n">random_added</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;prince&quot;</span><span class="p">,</span> <span class="s2">&quot;princess&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;banker&quot;</span><span class="p">,</span> <span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
         <span class="s2">&quot;cousin&quot;</span><span class="p">,</span> <span class="s2">&quot;neice&quot;</span><span class="p">,</span> <span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="s2">&quot;dude&quot;</span><span class="p">,</span> <span class="s2">&quot;guy&quot;</span><span class="p">,</span> <span class="s2">&quot;gal&quot;</span><span class="p">,</span> <span class="s2">&quot;fire&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;bluee&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">,</span>
         <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;brother&quot;</span><span class="p">,</span> <span class="s2">&quot;sister&quot;</span><span class="p">]</span>

<span class="n">lang</span> <span class="o">=</span> <span class="n">SpacyLanguage</span><span class="p">(</span><span class="s2">&quot;en_core_web_md&quot;</span><span class="p">)</span>
<span class="n">emb</span> <span class="o">=</span> <span class="n">lang</span><span class="p">[</span><span class="n">words</span><span class="p">]</span>

<span class="n">emb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">random_added</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">plot_interactive_matrix</span><span class="p">(</span><span class="s1">&#39;rand_0&#39;</span><span class="p">,</span> <span class="s1">&#39;rand_1&#39;</span><span class="p">,</span> <span class="s1">&#39;rand_2&#39;</span><span class="p">)</span>
</code></pre></div>

</div>
<h2 id="whatlies.transformers.umap"><code class="codehilite"><span class="n">umap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code><a class="headerlink" href="#whatlies.transformers.umap" title="Permanent link">&para;</a></h2>
<div class="autodoc">
<details class="note"><summary>Show source code in <code>whatlies/transformers.py</code></summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This transformer transformers all vectors in an [EmbeddingSet][whatlies.embeddingset.EmbeddingSet]</span>
<span class="sd">    by means of umap. We&#39;re using the implementation in [umap-learn](https://umap-learn.readthedocs.io/en/latest/).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        n_components: the number of compoments to create/add</span>
<span class="sd">        kwargs: keyword arguments passed to the UMAP algorithm</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    from whatlies.language import SpacyLanguage</span>
<span class="sd">    from whatlies.transformers import pca</span>

<span class="sd">    words = [&quot;prince&quot;, &quot;princess&quot;, &quot;nurse&quot;, &quot;doctor&quot;, &quot;banker&quot;, &quot;man&quot;, &quot;woman&quot;,</span>
<span class="sd">             &quot;cousin&quot;, &quot;neice&quot;, &quot;king&quot;, &quot;queen&quot;, &quot;dude&quot;, &quot;guy&quot;, &quot;gal&quot;, &quot;fire&quot;,</span>
<span class="sd">             &quot;dog&quot;, &quot;cat&quot;, &quot;mouse&quot;, &quot;red&quot;, &quot;bluee&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;water&quot;,</span>
<span class="sd">             &quot;person&quot;, &quot;family&quot;, &quot;brother&quot;, &quot;sister&quot;]</span>

<span class="sd">    lang = SpacyLanguage(&quot;en_core_web_md&quot;)</span>
<span class="sd">    emb = lang[words]</span>

<span class="sd">    emb.transform(umap(3)).plot_interactive_matrix(&#39;umap_0&#39;, &#39;umap_1&#39;, &#39;umap_2&#39;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">embset</span><span class="p">):</span>
        <span class="n">tfm</span> <span class="o">=</span> <span class="n">UMAP</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">names</span><span class="p">,</span> <span class="n">embs</span> <span class="o">=</span> <span class="n">embset_to_X</span><span class="p">(</span><span class="n">embset</span><span class="o">=</span><span class="n">embset</span><span class="p">)</span>
        <span class="n">new_vecs</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">embs</span><span class="p">)</span>
        <span class="n">names_out</span> <span class="o">=</span> <span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;umap_</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)]</span>
        <span class="n">vectors_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">new_vecs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_components</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">EmbeddingSet</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">orig</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_out</span><span class="p">,</span> <span class="n">vectors_out</span><span class="p">)},</span>
                            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{embset.name}</span><span class="s2">.umap_</span><span class="si">{n_components}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div>
</td></tr></table>

</details>
<p>This transformer transformers all vectors in an <a href="None#whatlies.embeddingset.EmbeddingSet">EmbeddingSet</a>
by means of umap. We're using the implementation in <a href="https://umap-learn.readthedocs.io/en/latest/">umap-learn</a>.</p>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_components</code></td>
<td></td>
<td>the number of compoments to create/add</td>
<td><code>2</code></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td></td>
<td>keyword arguments passed to the UMAP algorithm</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">whatlies.language</span> <span class="kn">import</span> <span class="n">SpacyLanguage</span>
<span class="kn">from</span> <span class="nn">whatlies.transformers</span> <span class="kn">import</span> <span class="n">pca</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;prince&quot;</span><span class="p">,</span> <span class="s2">&quot;princess&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;banker&quot;</span><span class="p">,</span> <span class="s2">&quot;man&quot;</span><span class="p">,</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
         <span class="s2">&quot;cousin&quot;</span><span class="p">,</span> <span class="s2">&quot;neice&quot;</span><span class="p">,</span> <span class="s2">&quot;king&quot;</span><span class="p">,</span> <span class="s2">&quot;queen&quot;</span><span class="p">,</span> <span class="s2">&quot;dude&quot;</span><span class="p">,</span> <span class="s2">&quot;guy&quot;</span><span class="p">,</span> <span class="s2">&quot;gal&quot;</span><span class="p">,</span> <span class="s2">&quot;fire&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;bluee&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">,</span>
         <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;brother&quot;</span><span class="p">,</span> <span class="s2">&quot;sister&quot;</span><span class="p">]</span>

<span class="n">lang</span> <span class="o">=</span> <span class="n">SpacyLanguage</span><span class="p">(</span><span class="s2">&quot;en_core_web_md&quot;</span><span class="p">)</span>
<span class="n">emb</span> <span class="o">=</span> <span class="n">lang</span><span class="p">[</span><span class="n">words</span><span class="p">]</span>

<span class="n">emb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">umap</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">plot_interactive_matrix</span><span class="p">(</span><span class="s1">&#39;umap_0&#39;</span><span class="p">,</span> <span class="s1">&#39;umap_1&#39;</span><span class="p">,</span> <span class="s1">&#39;umap_2&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../embeddingset/" title="EmbeddingSet" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                EmbeddingSet
              </span>
            </div>
          </a>
        
        
          <a href="../language/" title="Language" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Language
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>